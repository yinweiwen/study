# 物联网卡归属项目管理方案

## 背景与问题描述

目前，我司在物联网卡管理方面存在以下问题：
1. **信息填写不全**：物联网卡信息在监测平台上填写不完整，导致无法有效管理和定位物联网卡的使用情况。
2. **信息缺失**：部分物联网卡的信息缺失，无法确定其归属的项目，导致管理混乱。
3. **无法定位**：由于信息不全或缺失，无法通过现有平台准确定位物联网卡的使用位置和项目归属。

## 目标

本方案旨在通过以下措施解决上述问题：
1. **历史项目物联网卡管理**：通过定位查询历史项目中物联网卡的使用位置，确定其归属项目。
2. **设备运维管理平台**：通过设备管理平台获取物联网卡的项目相关信息，确保物联网卡与项目的绑定关系清晰。

## 方案实施

### 1. 针对历史项目的物联网卡管理

对于历史项目中的物联网卡，虽然卡号管理不完善，但可以通过定位查询大致确定其使用位置。具体步骤如下：

#### 1.1 定位查询接口

使用移动[OneLink](https://ec.iot.10086.cn/ecology/homePage)平台提供的定位查询接口，获取物联网卡的最后上网位置。接口如下：

- **接口名称**：`ec/query/district-position-location-message`
- **功能**：实时主动获取终端区域位置或非实时获取最后上网位置。
- **支持类型**：NB物联卡实时区号查询（仅开机状态下），最后上网位置经纬度查询、最后上网位置区号查询（暂不支持NB物联卡定位）。

#### 1.2 收费标准

| 资费包         | 次数       | 价格 ( 元 )  | 有效期 |
| -------------- | ---------- | ------------ | ------ |
| 5000元服务包   | 150,000    | ￥5,000.00   | 12月   |
| 20000元服务包  | 1,000,000  | ￥20,000.00  | 12月   |
| 50000元服务包  | 5,000,000  | ￥50,000.00  | 12月   |
| 100000元服务包 | 20,000,000 | ￥100,000.00 | 12月   |

#### 1.3 实施步骤

1. **购买服务包**：根据需求选择合适的服务包，确保有足够的查询次数。
2. **调用接口**：通过`OneLink`平台调用定位查询接口，获取物联网卡的最后上网位置。
3. **匹配项目位置**：将获取的最后上网位置与平台结构物位置进行匹配，确定物联网卡归属的项目。
4. **输出台账**：生成物联网卡使用位置台账，记录每张卡的归属项目和使用位置。

### 2. 设备运维管理平台

通过设备管理平台注册和配置的设备，能够获取其物联网卡的项目相关信息。具体步骤如下：

#### 2.1 设备注册与信息上报

设备在注册连接设备管理平台时，会上报包含物联网卡相关信息的数据。上报的信息格式如下：

```json
{
	"CK":
	{
		"DID":"RTPS12345678", // 设备唯一编码
		"CCID":"89860842032490013078", // SIM卡号ICCID
		"IMEI":"864035069197748", // 模块IMEI号
		"GL":"118.59E_23.25N", // 经纬度
	}
}
```

#### 2.2 设备配置管理

设备管理平台下发和管理设备的配置，包括数据上报服务器地址、DTU编号或MQTT消息地址等信息。这些信息与安心云监测平台关联绑定，确保物联网卡与项目的配置信息一致。

#### 2.3 实施步骤

1. **设备注册**：将设备注册到设备管理平台，确保设备上报的信息中包含物联网卡的相关信息。
2. **配置下发**：通过设备管理平台下发设备的配置信息，确保设备与安心云监测平台的绑定关系。
3. **信息同步**：将设备管理平台中的物联网卡信息同步到安心云监测平台，确保物联网卡与项目的绑定关系清晰。
4. **台账管理**：生成物联网卡与项目的绑定台账，记录每张卡的归属项目和使用情况。

## 预期效果

1. **历史项目物联网卡管理**：通过定位查询接口，能够确定历史项目中物联网卡的归属项目，生成使用位置台账，解决信息不全和缺失的问题。
2. **设备运维管理平台**：通过设备管理平台，能够实时获取物联网卡的项目相关信息，确保物联网卡与项目的绑定关系清晰，避免管理混乱。

## 总结

本方案通过定位查询和设备管理平台的结合，解决了物联网卡信息不全、缺失以及无法定位的问题。通过历史项目的定位查询和设备运维管理平台的信息同步，能够有效管理物联网卡的归属项目，确保物联网卡的使用情况清晰可查。